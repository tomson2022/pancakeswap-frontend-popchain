# Git 推送配置规则

## 问题描述

在 macOS 系统上，如果配置了系统代理，Git 默认不会使用代理，导致无法连接到 GitHub。

## 症状

```bash
fatal: unable to access 'https://github.com/...': Failed to connect to github.com port 443 after 75001 ms: Couldn't connect to server
```

## 解决方案

### 1. 检查系统代理配置

```bash
# 检查 Wi-Fi 代理
networksetup -getwebproxy "Wi-Fi"

# 检查以太网代理
networksetup -getwebproxy "Ethernet"
```

### 2. 为 Git 配置代理

如果系统代理是 `127.0.0.1:1087`，执行：

```bash
git config --global http.proxy http://127.0.0.1:1087
git config --global https.proxy http://127.0.0.1:1087
```

### 3. 验证配置

```bash
git config --global --get http.proxy
git config --global --get https.proxy
```

### 4. 推送代码

```bash
git push origin main
```

## 取消代理配置

如果不再需要代理，可以取消：

```bash
git config --global --unset http.proxy
git config --global --unset https.proxy
```

## 使用 Personal Access Token

如果使用 HTTPS 方式推送，需要在 remote URL 中包含 token：

```bash
git remote set-url origin https://ghp_<TOKEN>@github.com/username/repo.git
```

## 注意事项

1. **代理地址可能不同**：根据实际系统代理配置调整端口号
2. **SSH 方式**：如果使用 SSH，需要配置 SSH 代理，而不是 HTTP 代理
3. **临时使用**：可以使用 `--local` 而不是 `--global` 来只对当前仓库生效

## 相关命令

```bash
# 查看所有 Git 配置
git config --list

# 查看远程仓库 URL
git remote -v

# 测试 GitHub 连接
curl -I https://github.com
ssh -T git@github.com
```

## 历史记录

- **2024-11-08**: 首次记录推送配置规则
  - 问题：系统代理 127.0.0.1:1087，Git 未配置代理
  - 解决：配置 Git 全局代理后成功推送

